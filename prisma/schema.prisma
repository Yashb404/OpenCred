// This is your Prisma schema file.
// Learn more about it in the docs: https://pris.ly/d/prisma-schema

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

// User model
model User {
  id            String        @id @default(cuid())
  email_address String        @unique
  first_name    String        @map("first_name")
  last_name     String        @map("last_name")
  createdAt     DateTime      @default(now()) @map("created_at")

  // --- Relationships ---
  bankAccounts  BankAccount[]
  creditScores  CreditScore[]

  @@map("users")
}

// BankAccount model
model BankAccount {
  id            Int       @id @default(autoincrement())
  userId        String    @map("user_id")  
  accountName   String    @map("account_name")
  accountNumber String    @map("account_number") 
  ifscCode      String    @map("ifsc_code")
  linkedAt      DateTime  @default(now()) @map("linked_at")

  // --- Relationships ---
  user          User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("bank_accounts")
}

// CreditScore model
model CreditScore {
  id            Int       @id @default(autoincrement())
  userId        String    @map("user_id") // <-- must match User.id type
  score         Int
  scoreFactors  Json      @map("score_factors")
  generatedAt   DateTime  @default(now()) @map("generated_at")

  // --- Relationships ---
  user          User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("credit_scores")
}
